# 엘라스틱 스택이란
> 검색엔진을 넘어서 빅데이터 플랫폼으로 
  
# 엘라스틱서치의 탄생

* 전문 검색 기능을 제공하는 강력한 소프트웨어의 필요성이 있었다.   
   
검색 서비스는 계속해서 등장하고 있었지만, 구현체가 공개되지 않았었기에      
일반 개발자는 검색 이면에 숨은 비밀에 접근하기 어려웠고 검색 솔루션을 제공하는 벤더에 의존적일 수 밖에 없었다.     
이는 기업용 검색 기능의 발전에 크나큰 걸림돌이 되었다.    
 
루씬을 기반으로 컴파스 프로젝트를 진행하던 샤이 배넌은      
버전3에 이르러서 많은 부분을 재작성해 확장 가능한 검색 엔진 솔루션을 만들면 좋겠다는 생각을 하게 된다.  

* 처음부터 분산 환경을 위한 솔루션
* HTTP 상에서 JSON으로 인터페이스를 지원하는 솔루션
* 자바 이외에도 다양한 프로그래밍 언어를 지원하는 솔루션    

이외에도 다양한 요소들을 표방하고 작업에 들어간 배넌은 2010년 2월 엘라스틱서치를 공개한다.  

# 엘라스틱 스택으로 발전
  
엘라스틱은 단순 검색 엔진에 머무르는 대신 플랫폼으로 발전하는 길을 택했다.       
데이터를 수집, 가공, 저장, 분석 시각화하는 일련의 파이프라인을 구성하기 위해          
다양한 오픈소스 소프트웨어를 조합해야하는 불편함이 있었다.      
엘라스틱은 바로 이 지점에서 사용자의 가려운곳을 긁어주는 해법을 제시했다.     
배넌은 친분이 있는 개발자와 합심하여 엘라스틱서치에 로그 스태시, 키바나를 합친 엘라스틱 스택을 개발했다.   


# 엘라스틱 스택의 구성요소 
 
엘라스틱 스택은 일반적인 빅데이터 파이프라인을 구성하기 위한      
데이터 수집, 가공, 저장, 분석, 시각화에 필요한 모든 소프트웨어를 갖추고 있다.    

* 엘라스틱서치 : 분산검색엔진
* 키바나 : 시각화와 엘라스틱서치 관리 도구
* 로그스태시 : 이벤트 수집과 정체를 위한 도구
* 비츠 : 엣지단에서 동작하는 경량 수집 도구 

# 엘라스틱 스택의 용도 

## 1. 전문(full text) 검색 엔진

* 문장부터 뉴스 기사나 논문등 다양한 글의 전체 내용을 검색가능하다.   
* 빠르고 정확한 전문 검색을 위해, 용어 단위로 분석해 인덱싱해두고 이를 기반으로 검색을 수행하는 역인덱싱 방식을 많이 활용된다.  
* 엘라스틱 스택에는 용어 분석을 위한 다양한 언어별 분석기가 준비되어 있고,  
  유사도 스코어링을 위해서도 다양한 방법을 제공한다.
    * 원문을 어떻게 수집하고,   
    * 어떤 방식으로 분석해 용어를 만들고,   
    * 검색시에 어떤 기준으로 유사도를 측정하고   
    * 어떤 문서를 결과 상단에 위치시킬지와 같은 작업은 단순하지 않다.    
* 전문 검색외에도 레거시 관계형 데이터베이스에 대한 외부 검색 엔진으로 활용되기도 한다.   
    * 원문을 저장할 필요가 없기에 큰 용량을 차지하지는 않으면서도 빠른 검색 성능을 기대할 수 있다.   
* 검색엔진용도로 엘라스틱서치를 활용할 때는 일반적으로 도큐먼트의 양이 다른 용도에 비해 많지 않기 때문에     
  상대적으로 작은 클러스터 크기로도 충분한 활용이 가능하며 레플리카수를 늘려 동일 인덱스에 대한 검색 성능을 높일 수 있다.    
      
## 2. 로그 통합 분석

엘라스틱 스택은 여러 장비의 로그들을 빠르게 수집할 수 있고,      
로그스태시는 다양한 필터를 통해 일원화된 형태로 가공을 도우며,      
엘라스틱서치의 대용량 로그에 대한 빠른 인덱싱 성능과 텍스트 검색 능력은 여러 곳에 흩어진 서비스 로그들을 통합해서 연관 분석을 지원한다.     
키바나의 로그 UI나 대시보드는 시계열로 발생하는 로그들을 직관적으로 모니터링할 수 있도록 도와준다.(한페이지에서 실시간으로)  

## 3. 보안 이밴트 분석  
      
보안과 관련된 이벤트는 로그와 비교해도 무시할 수 없는 수준의 양을 가졌다.     
하지만 공격 방식의 다변화에 따라 이 이벤트들은 실시간으로 수집됨과 동시에         
실시간 검색과 필터링을 통한 연관분석과 머신러닝을 이용한 이상 징후 탐지까지 연결되어야한다.      
키바나에서 제공하는 엘라스틱 이벤트 분석 화면을 통해 다양한 데이터를 실시간으로 UI를 통해 확인할 수 있다.      

## 4. 애플리케이션 성능 분석     
  
안정적인 서비스를 유지하려면 애플리케이션의 상태를 지속적으로 모니터링해야한다.     
엘라스틱 스택의 애플리케이션 성능 모니터링 도구인 APM은     
프로그래밍 언어별 에이전트를 통해 성능 지표 수집을 돕고 분석을 위한 UI를 제공한다.    
 
## 5. 머신러닝 

엘라스틱 스택에서 유로 라이선스를 구매할 경우 사용할 수 있는 강력한 기능 중 하나다.  

# 빅데이터 플랫폼의 일부로 동작하는 엘라스틱 스택 
## 엔터프라이즈 데이터 버스인 카프카와 연동 
    
아파치 카프카는 분산 데이터 스트리밍 플랫폼이다.    
대량의 데이터를 실시간으로 배포하는데 최적화되어 있어, 많은 빅데이터 플랫폼에서 기본적으로 채택하고 있다.   
   
카프카와 엘라스틱 스택은 데이터 수집 시점에서 많이 연계되어 사용한다.    
비츠에서 수집한 각 장비의 이벤트를 카프카로 전송하고 이를 로그스태시로 다시 읽어들이거나     
카프카에 저장된 다른 시스템의 이벤트를 엘라스틱서치로 읽어들이는 등의 구성으로 자주 사용한다.  
데이터의 유실이 방지되며 타 시스템과 데이터 연계가 손 쉬워진다는 장점이 있다.   

## 하둡 생태계와 연동 
  
엘라스틱 스택에서 es-hadoop 모듈을 사용하면     
스파크에서 엘라스틱서치 API를 사용해 도큐먼트를 읽어들이고       
반대로 인덱싱하는 등 서로 상호작용을 수행할 수 있다.    
  
엘라스틱서치는 이미 인덱싱된 결과에 대해 빠른 검색을 제공하는 스파크는       
기존에 인덱싱되지 않은 데이터에 대한 빠른 일괄 처리를 제공하기 때문에      
엘라스틱서치를 중간 집계 엔진이나 결과를 저장해 재활용하는 용도 등으로 활용할 수 있다.      
  
두 솔루션에 모두 익숙해진다면 서로의 단점을 보완해 가장 빠르게 원하는 결과를 도출할 수 있다.  
     
## 관계형 데이터베이스와 연동 
    
관계형 데이터베이스에는 주로 레거시 데이터나 신뢰성이 중요한 데이터가 포함되어 있다.        
로그스태시는 JDBC 입력 플러그인, 필터 등 관계형 데이터베이스와 연계할 수 있는 다양한 방법을 제공하고 있다.     
기존의 관계형 데이터베이스에 저장된 데이터를 인덱싱하거나 입력받는 이벤트에 정보를 주입하는 등 여러 용도로 사용된다.  
 
JDBC입력 플로그인을 사용해 관계형 데이터베이스에 저장된 데이터를 엘라스틱서치로 이전할 경우,     
엘라스틱 스택의 우수한 성능을 이용해 곤계형 데이터베이스로 처리하기 어려운 집계도 빠르고 정확하게 처리할 수 있다.    
   
또한 텍스트 데이터의 경우 엘라스틱서치에서는 색인만 수행하고 원문을 저장하지 않게 설정하는 방식을 이용해        
저장소 용량을 아껴 쓰면서 검색 엔진의 전문 검색 기능만 활용하는 경우도 있다.    
JDBC필터를 사용할 경우 관계형 데이터베이스에서 실 데이터를 불러와 매핑하는 용도로 이벤트에 ID형태로만 기록되는 정보를 활용할 수 있다.  

