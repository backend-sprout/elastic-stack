# HTTP 계층과 전송 계층

클러스터는 여러개의 노드로 이루어지고, 노드들은 서로 통신하면서 클러스터를 구성하고 있다.  
노드는 2가지 통신모듈이 있는데 아래와 같다.  

1. 전송 모듈 : 클러스터 내부에서 노드와 노드 간의 통신에 사용된다.   
2. HTTP 모듈 : REST API를 통해 주로 노드와 외부 클라이언트와 통신한다.  

|통신 모듈|특징|
|-------|---|
|전송 모듈|* 클러스터 내붕 모듈간의 통신에 사용함<br>* 노드 간 데이터를 분산 처리하는 구조에 적합한 방식<br>* 기본 포트: 9300 ~ 9399|
|HTTP 모듈|* 엘라스틱 API에서 제공하는 형태로 외부 클라이언트 앱과 통신시 사용함<br>* 기본 포트: 9200 ~ 9299|

# 노드 
    
노드는, 클러스터를 구성하는 하나의 인스턴스다.       
일반적으로 하나의 논리적인 서버로 구성되어 데이터를 저장하고 클러스터의 인덱싱과 검색 기능에 참여한다.    
물리적인 서버 하나에 노드 하나를 구성하는 방식을 권장하지만, 단일 서버에 복수의 노드를 설치할 수도 있다.     

## 마스터 노드

* 클러스터는 반드시 하나의 마스터 노드를 가져야한다.  
 
마스터 노드는 `인덱스의 설정`, `매핑 정보와 물리적 위치`,    
이외에도 클러스터 설정 정보나 인덱스 템플릿 정보등 클러스터의 모든 상태 정보를 관리한다.  
(노드들과 통신하면서 모니터링도 진행)

마스터 노드는, 다수의 마스터 후보 노드가 투표를 통해 결정한다. 

### 마스터 노드 선출 과정 

클러스터내의 마스터 후보 노드들은 투표를 통해 마스터 노드를 선출한다.   
정족수 이상의 표를 받은 노드가 마스터 노드가 된다.  
    
**기존 마스터 노드가 장애 같은 이유로 이탈이 된다면? 🤔**      
마스터 노드를 다시 선출하는 투표가 이루어지고, 마찬가지로 정족수 이상의 표를 받은 노드가 마스터 노드가 된다.       
  
**이탈했던 기존 마스터 노드가 복구가 된다면? 🤔**        
이미 마스터 노드를 선출했기에 다시 선출하는 과정은 발생하지 않는다.  



