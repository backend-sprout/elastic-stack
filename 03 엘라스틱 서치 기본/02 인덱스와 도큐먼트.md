# 인덱스와 도큐먼트

인덱스는 도큐먼트를 저장하는 논리적 구분자이며,  
도큐먼트는 실제 데이터를 저장하는 단위다.   

일반적으로 엘라스틱을 이용해 시스템을 개발하면 하나의 프로젝트에서 하나의 클러스터를 생성한다.    
그리고 클러스터 내부는 데이터 성격에따라 여러 개의 인덱스를 생성한다.   

인덱스 내부에는 JSON 형태로 된 다수의 도큐먼트가 존재하고 도큐먼트는 복수의 필드를 갖는다.   

## 도큐먼트 

엘라스틱 서치에서 데이터가 저장되는 가장 기본 단위로 JSON 형태이다.      
하나의 도큐먼트는 Filed 와 Value를 갖는다.   

RDB의 경우 SQL을 이용해서 데이터를 저장한다.     
이 과정에서 테이블과 각각의 컬럼이 필요하다.    

반면에, 엘라스틱 서치는 데이터를 JSON 형태로 저장한다.   

```
{
    "name" : "mike",
    "age" : 25,
    "gender" : "male"
}
```

* 도큐먼트에는 name, age, gender 라는 필드가 생기고
  mike, 25, male 이라는 필드의 값으로 채워졌다.   
* 참고로, 엘라스틱 서치 7.x 이전 버전에서는 타입이 존재했으나 타입이 사라지면서 이에대한 설명은 더 이상 유효하지 않다.  

|MySQL|엘라스틱 서치|
|-----|---------|
|테이블|인덱스|
|레코드|도큐먼트|
|컬럼|필드|
|스키마|매핑|

## 인덱스 

인덱스는 도큐먼트를 저장하는 논리적 단위로, 관계형 데이터베이스의 테이블과 유사한 개념이다.   
하나의 인덱스에 다수의 도큐먼트가 포함되는 구조인데, 동일한 인덱스에 있는 도큐먼트는 동일한 스키마를 갖는다.   
그리고 모든 도큐먼트는 반드시 하나의 인덱스에 포함돼야한다.   
 
### 스키마에 따른 그룹핑

일반젇으로 스키마에따라 인덱스를 구분한다.   
회원 정보 도큐먼트와 장바구니 도큐먼트는 성격이 다르기 때문에 데이터 스키마도 다르다.    
이렇게 서로 다른 스키마를 가진 도큐먼트를 하나의 인덱스에 저장하는 방법은 바람직하지 않다.  

### 관리 목적의 그룹핑 
    
인덱스는 용량이나 숫자 제한 없이 무한대의 도큐먼트를 포함할 수 있다.       
따라서 이론적으로는 하나의 인덱스에 수억개의 도큐먼트도 저장될 수 있다.       
하지만, 인덱스의 커지면 검색시 많은 도큐먼트를 참조해야하기에 성능이 나빠진다.    
**그래서 엘라스틱서치를 운용하면 인덱스 용량 제한을 두게 된다.**    
  
빅데이터 시스템은 데이터가 커서 디스크 용량이 부족해지거나 시스템 가용성 차원에서 데이터 정제 작업이 많은데      
이를 효율적으로 처리하기 위해 데이터를 관리 목적으로 그룹핑하는 경우가 많다.   

